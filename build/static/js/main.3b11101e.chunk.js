(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{481:function(e,t,a){e.exports=a(705)},704:function(e,t,a){},705:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(22),o=a.n(c),l=a(15),s=a.n(l),i=a(27),u=a(18),m=a(21),d=r.a.createContext(),p=a(43),f=a.n(p),h="/2053/",b=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"post",url:"/api/login",headers:{"Content-Type":"application/json;charset=utf-8"},data:t});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"post",url:h+"api/signup",headers:{"Content-Type":"application/json;charset=utf-8"},data:{username:t.username,email:t.email,password:t.password}});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"get",url:"".concat(h,"api/user/").concat(t),headers:{"Content-Type":"application/json;charset=utf-8"}});case 2:return a=e.sent,e.abrupt("return",a.data.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"get",url:"".concat(h,"api/user"),headers:{"Content-Type":"application/json;charset=utf-8"}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"delete",url:"".concat(h,"api/user/").concat(t),headers:{"Content-Type":"application/json;charset=utf-8"}});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(i.a)(s.a.mark((function e(t,a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"put",url:"".concat(h,"api/user"),headers:{"Content-Type":"application/json;charset=utf-8"},data:{username:t,data:a}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),y=function(){var e=Object(i.a)(s.a.mark((function e(t,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("addFav"),e.next=3,f()({method:"post",url:"".concat(h,"api/favourite/stop"),headers:{"Content-Type":"application/json;charset=utf-8"},data:{stop_id:t,username:a}});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),w=function(){var e=Object(i.a)(s.a.mark((function e(t,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("removeFav"),e.next=3,f()({method:"delete",url:"".concat(h,"api/favourite/stop/").concat(a,"/").concat(t),headers:{"Content-Type":"application/json;charset=utf-8"}});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),C=function(e){var t=Object(n.useState)({username:null,email:null,fav_locations:[],logged_in:!1,isAdmin:!1,location:{lat:22.2988,long:114.1722}}),a=Object(m.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),p=Object(m.a)(l,2),f=p[0],h=p[1],C=Object(n.useState)(!1),x=Object(m.a)(C,2),N=x[0],k=x[1],S=function(){var e=Object(i.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,b(t);case 3:if(200!==(a=e.sent).status){e.next=12;break}return e.next=7,E(t.username);case 7:n=e.sent,o(Object(u.a)(Object(u.a)({},c),{},{username:n.username,email:n.email,fav_locations:n.fav_stops,logged_in:!0})),h(!1),e.next=15;break;case 12:return console.log(a),h(!1),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(Object(u.a)(Object(u.a)({},c),{},{username:"Admin",logged_in:!0,isAdmin:!0}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:if(200!==(t=e.sent).status){e.next=7;break}return e.abrupt("return",t.data);case 7:console.log("ERROR");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,g({username:t.username,email:t.email,password:t.password,fav_locations:[],logged_in:!0});case 3:if(200!==e.sent.status){e.next=12;break}return e.next=7,E(t.username);case 7:a=e.sent,o(Object(u.a)(Object(u.a)({},c),{},{username:a.username,email:a.email,fav_locations:a.fav_stops,logged_in:!0})),h(!1),e.next=14;break;case 12:return h(!1),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g({username:t.username,email:t.email,password:t.password});case 2:if(200!==e.sent.status){e.next=8;break}return e.next=6,E(t.username);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t);case 2:if(200!==e.sent.status){e.next=5;break}return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(i.a)(s.a.mark((function e(t,a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t,a);case 2:if(200!==e.sent.status){e.next=8;break}return e.next=6,E(a.username);case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){console.log("TEST","UserProvider"),!N&&c.logged_in&&(navigator.geolocation.getCurrentPosition((function(e){o(Object(u.a)(Object(u.a)({},c),{},{location:{lat:e.coords.latitude,long:e.coords.longitude}}))})),k(!0))})),r.a.createElement(d.Provider,{value:{user:c,setUser:o,loading:f,login:S,loginAsAdmin:_,signUp:T,signout:function(){o(Object(u.a)(Object(u.a)({},c),{},{logged_in:!1,isAdmin:!1})),k(!1)},favorite:function(e){var t=Object(u.a)({},c);if(c.fav_locations){var a=c.fav_locations.findIndex((function(t){return e===t}));a>-1?(t.fav_locations.splice(a,1),w(e,c.username)):(t.fav_locations.push(e),y(e,c.username))}else t.fav_locations=[e],y(e,c.username);o(t)},isFavorite:function(e){return!!c.fav_locations&&c.fav_locations.findIndex((function(t){return e==t}))>-1},deleteUser:F,updateUser:L,createUser:A,getAllUsers:R}},e.children)},x=a(78),N=a(66),k=Object(N.a)(),S=a(744),_=a(727),R=a(747),T=a(743),A=a(460),F=a(728),L=a(106),P=a(24),D=a(25),M=function(){var e=Object(n.useState)("id"),t=Object(m.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),l=Object(m.a)(o,2),s=l[0],i=l[1],u=Object(n.useContext)(d);return r.a.createElement(S.a,{className:"header navbar-dark",expand:"lg"},r.a.createElement(_.a,null,r.a.createElement(S.a.Brand,{className:"brand"},"Bus Stops"),r.a.createElement(S.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(S.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(R.a,{className:"mr-auto"},r.a.createElement(R.a.Item,null,r.a.createElement(L.a,{to:"".concat("/2053","/list"),className:"header-link"},"List",r.a.createElement(P.a,{className:"fa-list",icon:D.g}))),r.a.createElement(R.a.Item,null,r.a.createElement(L.a,{to:"".concat("/2053","/map"),className:"header-link"},"Map",r.a.createElement(P.a,{className:"fa-map ",icon:D.h}))),r.a.createElement(R.a.Item,null,r.a.createElement(L.a,{to:"".concat("/2053","/about"),className:"header-link"},"About",r.a.createElement(P.a,{className:"fa-info",icon:D.f})))),r.a.createElement("div",{className:"searchbar"},r.a.createElement(T.a,{inline:!0,onSubmit:function(e){e.preventDefault(),k.push("/search/".concat(a,"/").concat(""==s?"all":s))}},r.a.createElement(A.a,{type:"text",placeholder:"Search",onChange:function(e){i(e.target.value)},value:s,className:"mr-sm-2 searchbar-text"}),r.a.createElement(T.a.Control,{className:"searchSelect",as:"select",onChange:function(e){c(e.target.value)},value:a,custom:!0},r.a.createElement("option",{value:"id"},"ID"),r.a.createElement("option",{value:"name"}," Name"),r.a.createElement("option",{value:"lat"},"Lat"),r.a.createElement("option",{value:"long"},"Lng"),u.user.logged_in?r.a.createElement("option",{value:"nearby"},"Nearby(km)"):r.a.createElement(r.a.Fragment,null)),r.a.createElement(F.a,{type:"submit",variant:"secondary",className:"searchbar-button"},r.a.createElement(P.a,{icon:D.l,className:"searchbar-icon"})))),r.a.createElement(R.a.Item,{className:"header-link login-status"},r.a.createElement(L.a,{to:u.user.isAdmin?"".concat("/2053","/admin"):"".concat("/2053","/"),className:"header-link"},u.user.logged_in?r.a.createElement(r.a.Fragment,null,u.user.username,r.a.createElement(P.a,{className:"fa-user",icon:D.s})):r.a.createElement(r.a.Fragment,null,"Log In",r.a.createElement(P.a,{className:"fa-signin",icon:D.m})))))))},U=a(50),I=r.a.createContext([]),q=Object(U.GoogleApiWrapper)({apiKey:"AIzaSyCGXpHmTk63MUCUXfclORWPCTEh5B35qoQ"})((function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(null),s=Object(m.a)(l,2),i=s[0],u=s[1],d=Object(n.useContext)(I);return r.a.createElement("div",{className:"map-container"},c?r.a.createElement(x.a,{to:"/location/".concat(i)}):r.a.createElement(U.Map,{google:e.google,initialCenter:{lat:22.2988,lng:114.1722},zoom:14,className:"map"},d.locations.map((function(e){return r.a.createElement(U.Marker,{onClick:function(){return function(e){u(e),o(!0)}(e.stop_id)},title:e.name,name:e.name,position:{lat:e.lat,lng:e.long}})}))))})),G=a(731),V=a(730),B=a(61),z=a(745),H=a(729),W=function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),s=Object(m.a)(l,2),i=s[0],p=s[1],f=Object(n.useState)({id:e.id,name:e.name,lat:parseFloat(e.lat).toFixed(5),long:parseFloat(e.long).toFixed(5),company:e.company}),h=Object(m.a)(f,2),b=h[0],g=h[1],E=Object(n.useState)(b),v=Object(m.a)(E,2),j=v[0],O=v[1],y=Object(n.useContext)(d),w=Object(n.useContext)(I),C=Object(x.f)(),N=function(e){g(Object(u.a)(Object(u.a)({},b),{},Object(B.a)({},e.target.name,e.target.value)))};return c?r.a.createElement(x.a,{to:"/location/".concat(e.id)}):r.a.createElement("tr",{onClick:function(){console.log(e.page),i||"location"===e.page||o(!0)}},r.a.createElement("td",null,i?r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Control,{name:"id",type:"text",value:b.id,onChange:N,required:!0})):b.id),r.a.createElement("td",null,i?r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Control,{name:"name",type:"text",value:b.name,onChange:N})):b.name),r.a.createElement("td",null,i?r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Control,{name:"company",type:"text",value:b.company,onChange:N,required:!0})):b.company),r.a.createElement("td",null,i?r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Control,{name:"lat",type:"text",value:b.lat,onChange:N})):b.lat),r.a.createElement("td",null,i?r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Control,{name:"long",type:"text",value:b.long,onChange:N})):b.long),r.a.createElement("td",null,e.no_comments),r.a.createElement("td",null,e.favourite),y.user.isAdmin&&!i?r.a.createElement("td",null,r.a.createElement(z.a,{placement:"bottom",overlay:r.a.createElement(H.a,null,"Delete stop")},r.a.createElement(P.a,{className:"fa-trash",icon:D.r,onClick:function(t){t.stopPropagation(),1==window.confirm("Are you sure you want to delete this stop?")&&(w.deleteLoc(e.id),"location"===e.page&&C.push("/list"))}})),r.a.createElement(z.a,{placement:"bottom",overlay:r.a.createElement(H.a,null,"Edit stop")},r.a.createElement(P.a,{className:"fa-pencil-alt",icon:D.j,onClick:function(e){e.stopPropagation(),p(!0)}}))):i?r.a.createElement("td",null,r.a.createElement(z.a,{placement:"bottom",overlay:r.a.createElement(H.a,null,"Confirm edit")},r.a.createElement(P.a,{className:"fa-check",icon:D.a,onClick:function(e){e.stopPropagation(),p(!1),w.updateLoc(j.id,b),O(b)}})),r.a.createElement(z.a,{placement:"bottom",overlay:r.a.createElement(H.a,null,"Discard edit")},r.a.createElement(P.a,{className:"fa-times",icon:D.q,onClick:function(e){e.stopPropagation(),p(!1),g(j)}}))):r.a.createElement(r.a.Fragment,null))},X=function(e){var t=Object(n.useState)({sortName:null,reverse:!1,asc:!0}),a=Object(m.a)(t,2),c=a[0],o=a[1],l=Object(n.useContext)(d),s=e.locations,i=function(e,t){return e.localeCompare(t)},u=function(e,t){return e-t},p=function(t){var a=t.target.getAttribute("name"),n=a===c.sortName;if(n)s=s.reverse();else switch(a){case"id":e.locations.sort((function(e,t){return i(e.stop_id,t.stop_id)}));break;case"name":e.locations.sort((function(e,t){return i(e.name,t.name)}));break;case"lat":e.locations.sort((function(e,t){return u(e.lat,t.lat)}));break;case"long":e.locations.sort((function(e,t){return u(e.long,t.long)}));break;case"comments":e.locations.sort((function(e,t){return u(e.comments.length,t.comments.length)}));break;case"fav":e.locations.sort((function(e,t){return u(e.favourite,t.favourite)}))}o({sortName:a,reverse:n,asc:!n||!c.asc})};return r.a.createElement(V.a,{className:"loc-table",striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{name:"id",className:"id"===c.sortName?"sort-active":"",onClick:p},"ID","id"===c.sortName?c.asc?r.a.createElement(P.a,{className:"sort-icon",icon:D.p}):r.a.createElement(P.a,{className:"sort-icon",icon:D.o}):""),r.a.createElement("th",{name:"name",className:"name"===c.sortName?"sort-active":"",onClick:p},"Name","name"===c.sortName?c.asc?r.a.createElement(P.a,{className:"sort-icon",icon:D.p}):r.a.createElement(P.a,{className:"sort-icon",icon:D.o}):""),r.a.createElement("th",{name:"company",className:"company"===c.sortName?"sort-active":"",onClick:p},"Company","company"===c.sortName?c.asc?r.a.createElement(P.a,{className:"sort-icon",icon:D.p}):r.a.createElement(P.a,{className:"sort-icon",icon:D.o}):""),r.a.createElement("th",{name:"lat",className:"lat"===c.sortName?"sort-active":"",onClick:p},"Lat","lat"===c.sortName?c.asc?r.a.createElement(P.a,{className:"sort-icon",icon:D.p}):r.a.createElement(P.a,{className:"sort-icon",icon:D.o}):""),r.a.createElement("th",{name:"long",className:"long"===c.sortName?"sort-active":"",onClick:p},"Long","long"===c.sortName?c.asc?r.a.createElement(P.a,{className:"sort-icon",icon:D.p}):r.a.createElement(P.a,{className:"sort-icon",icon:D.o}):""),r.a.createElement("th",{name:"comments",className:"comments"===c.sortName?"sort-active":"",onClick:p},"Comments","comments"===c.sortName?c.asc?r.a.createElement(P.a,{className:"sort-icon",icon:D.p}):r.a.createElement(P.a,{className:"sort-icon",icon:D.o}):""),r.a.createElement("th",{name:"fav",className:"fav"===c.sortName?"sort-active":"",onClick:p},"Favourites","fav"===c.sortName?c.asc?r.a.createElement(P.a,{className:"sort-icon",icon:D.p}):r.a.createElement(P.a,{className:"sort-icon",icon:D.o}):""),l.user.isAdmin?r.a.createElement("th",{name:"operation"},"Operations"):r.a.createElement(r.a.Fragment,null))),r.a.createElement("tbody",null,s.map((function(t,a){if(t)return r.a.createElement(W,{name:t.name,id:t.stop_id,no_comments:t.comments.length,lat:t.lat,long:t.long,favourite:t.favourite,company:t.route_list[0].company,key:t.stop_id,page:e.page})}))))},J=function(){var e=Object(n.useContext)(I),t=Object(n.useContext)(d),a=Object(n.useState)(!1),c=Object(m.a)(a,2),o=c[0],l=c[1],s=Object(x.f)();return r.a.createElement(_.a,{className:"mt-3"},t.user.isAdmin?r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{variant:"primary",type:"submit",onClick:function(e){e.preventDefault(),s.push("/locationForm")},className:"mr-2"},"Create"),r.a.createElement(F.a,{variant:"secondary",type:"submit",onClick:function(){l(!0),e.reloadData().then((function(e){e?l(!1):console.log("Flushing error")}))}},o?r.a.createElement(G.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")):r.a.createElement(r.a.Fragment,null,"Flush Data"))):r.a.createElement(r.a.Fragment,null),r.a.createElement(X,{locations:e.locations,page:window.location.href.split("/")[3]}))},Q=a(732),Y=a(461),K=a(748),Z=function(e){var t=Object(n.useContext)(d),a=Object(n.useState)({username:{value:"",isValid:!1,validated:!1},email:{value:"",isValid:!1,validated:!1},password:{value:"",isValid:!1,validated:!1},confirm_pass:{value:"",isValid:!1,validated:!1}}),c=Object(m.a)(a,2),o=c[0],l=c[1],p=Object(n.useState)(!1),f=Object(m.a)(p,2),h=f[0],b=f[1],g=function(){var e=Object(i.a)(s.a.mark((function e(a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),a.stopPropagation(),a.target,o.username.isValid&&o.email.isValid&&o.password.isValid&&o.confirm_pass.isValid&&t.signUp({username:o.username.value,email:o.email.value,password:o.password.value}).then((function(e){e||b(!0)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(e){var t,a="username"===e.target.name||"password"===e.target.name,n=e.target.value.length>3&&e.target.value.length<21,r="confirm_pass"===e.target.name,c=o.password.value===e.target.value;l(Object(u.a)(Object(u.a)({},o),{},Object(B.a)({},e.target.name,Object(u.a)(Object(u.a)({},o[e.target.name]),{},(t={},Object(B.a)(t,"value",e.target.value),Object(B.a)(t,"validated",!0),Object(B.a)(t,"isValid",a?!!n:!r||!!c),t)))))};return r.a.createElement(T.a,{onSubmit:g},r.a.createElement(K.a,{variant:"danger",hidden:!h},"Username exists. Please use another username."),r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"User name"),r.a.createElement(T.a.Control,{name:"username",type:"text",placeholder:"Enter user name",onChange:E,value:o.username.value,isInvalid:!o.username.isValid&&o.username.validated,required:!0}),r.a.createElement(T.a.Control.Feedback,{type:"invalid"},"Please provide a valid username (4-20 characters)")),r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"Email address"),r.a.createElement(T.a.Control,{name:"email",type:"email",placeholder:"Enter email",onChange:E,value:o.email.value,isInvalid:!o.email.isValid&&o.email.validated,required:!0}),r.a.createElement(T.a.Control.Feedback,{type:"invalid"},"Please provide a valid email address")),r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"Password"),r.a.createElement(T.a.Control,{name:"password",type:"password",placeholder:"Password",onChange:E,value:o.password.value,isInvalid:!o.password.isValid&&o.password.validated,required:!0}),r.a.createElement(T.a.Control.Feedback,{type:"invalid"},"Please provide a valid password (4-20 characters)")),r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"Confirm Password"),r.a.createElement(T.a.Control,{name:"confirm_pass",type:"password",placeholder:"Confirm Password",onChange:E,value:o.confirm_pass.value,isInvalid:!o.confirm_pass.isValid&&o.confirm_pass.validated,required:!0}),r.a.createElement(T.a.Control.Feedback,{type:"invalid"},"Please enter the same password")),r.a.createElement(F.a,{variant:"primary",type:"submit"},"Sign Up"))},$=function(e){var t=Object(n.useContext)(d),a=Object(n.useState)({username:{value:"",isValid:!0},password:{value:"",isValid:!0}}),c=Object(m.a)(a,2),o=c[0],l=c[1],p=Object(n.useState)(!1),f=Object(m.a)(p,2),h=(f[0],f[1]),b=function(){var e=Object(i.a)(s.a.mark((function e(a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),t.login({username:o.username.value,password:o.password.value}).then((function(e){e||l({username:{value:"",isValid:!1},password:{value:"",isValid:!1}})})),h(!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(e){e.target.value;l(Object(u.a)(Object(u.a)({},o),{},Object(B.a)({},e.target.name,Object(u.a)(Object(u.a)({},o[e.target.name]),{},Object(B.a)({},"value",e.target.value)))))};return r.a.createElement(T.a,{onSubmit:b},r.a.createElement(K.a,{variant:"danger",hidden:o.username.isValid||o.password.isValid},"Invalid username or password."),r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"User name"),r.a.createElement(T.a.Control,{name:"username",type:"text",placeholder:"Enter user name",onChange:g,value:o.username.value,isInvalid:!o.username.isValid,required:!0})),r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"Password"),r.a.createElement(T.a.Control,{name:"password",type:"password",placeholder:"Password",onChange:g,value:o.password.value,isInvalid:!o.password.isValid,required:!0})),r.a.createElement(F.a,{variant:"primary",type:"submit"},"Login"))},ee=function(e){return r.a.createElement(_.a,{className:"mt-3"},r.a.createElement("div",{className:"grey-container"},r.a.createElement(Q.a,null,r.a.createElement(Y.a,null,r.a.createElement("h3",{className:"title-text"},"Login"),r.a.createElement($,null)),r.a.createElement(Y.a,null,r.a.createElement("h3",{className:"title-text"},"Sign Up"),r.a.createElement(Z,null)))))},te=a(113),ae=function(e){var t=e.locations;e.locations.sort((function(e,t){return function(e,t){return e-t}(e.comments.length,t.comments.length)}));var a=[],c=[];0!==(t=t.reverse())[0].comments.length&&(c.push(t[0].comments.length),a.push(t[0].name),0!==t[1].comments.length&&(c.push(t[1].comments.length),a.push(t[1].name),0!==t[2].comments.length&&(c.push(t[2].comments.length),a.push(t[2].name),0!==t[3].comments.length&&(c.push(t[3].comments.length),a.push(t[3].name),0!==t[4].comments.length&&(c.push(t[4].comments.length),a.push(t[4].name))))));var o=Object(n.useState)({chartData:{labels:a,datasets:[{label:"Comment Count",data:c,backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)"]}]}}),l=Object(m.a)(o,1)[0];return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"justify-content-center col"},r.a.createElement(te.a,{data:l.chartData,options:{title:{display:!0,text:"TOP 5 Most Commented Locations By All Users",fontSize:16,position:"right"},legend:{display:!1,position:"bottom"},scales:{xAxes:[{ticks:{beginAtZero:!0,stepSize:1},scaleLabel:{display:!0,labelString:"Total Number of Comments"}}]}}})))},ne=function(e){var t=e.locations;e.locations.sort((function(e,t){return function(e,t){return e-t}(e.favourite,t.favourite)}));var a=[],c=[];0!==(t=t.reverse())[0].favourite&&(c.push(t[0].favourite),a.push(t[0].name),0!==t[1].favourite&&(c.push(t[1].favourite),a.push(t[1].name),0!==t[2].favourite&&(c.push(t[2].favourite),a.push(t[2].name),0!==t[3].favourite&&(c.push(t[3].favourite),a.push(t[3].name),0!==t[4].favourite&&(c.push(t[4].favourite),a.push(t[4].name))))));var o=Object(n.useState)({chartData:{labels:a,datasets:[{label:"Total Number of Favourites",data:c,backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)"]}]}}),l=Object(m.a)(o,1)[0];return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"justify-content-center col"},r.a.createElement(te.a,{data:l.chartData,options:{title:{display:!0,text:"TOP 5 Most Favorited Locations By All Users",fontSize:16,position:"right"},legend:{display:!1,position:"bottom",align:"center"},scales:{xAxes:[{ticks:{beginAtZero:!0,stepSize:1},scaleLabel:{display:!0,labelString:"Total Number of Favorites"}}]},layout:{padding:{left:20}}}})))},re=Object(U.GoogleApiWrapper)({apiKey:"AIzaSyCGXpHmTk63MUCUXfclORWPCTEh5B35qoQ"})((function(e){var t=Object(n.useContext)(d),a=Object(n.useContext)(I);return r.a.createElement(_.a,{className:"mt-3"},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("h5",null,"Hello, ",t.user.username),r.a.createElement(F.a,{variant:"primary",type:"submit",onClick:function(e){e.preventDefault(),window.confirm("Are you sure you want to sign out?")&&t.signout()}},"Sign out",r.a.createElement(P.a,{className:"fa-signout",icon:D.n}))),r.a.createElement("hr",null),t.user.fav_locations.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",null,"Favorite Stops"),r.a.createElement(X,{locations:t.user.fav_locations.map((function(e){return a.findById(e)}))})):r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",null,"Favorite Stops:"),r.a.createElement("h6",null,"You dont have any favorite locations yet")),r.a.createElement("hr",null),r.a.createElement("div",{className:"map-container"},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("h5",null,"My location"),r.a.createElement(z.a,{placement:"top",overlay:r.a.createElement(H.a,null,"Mark current position")},r.a.createElement(P.a,{onClick:function(){navigator.geolocation.getCurrentPosition((function(e){t.setUser(Object(u.a)(Object(u.a)({},t.user),{},{location:{lat:e.coords.latitude,long:e.coords.longitude}}))}))},className:"fa-crosshair",icon:D.b}))),r.a.createElement("h6",null,"You can click on the map to modify your location"),r.a.createElement(U.Map,{onClick:function(e,a,n){return r=n.latLng,void t.setUser(Object(u.a)(Object(u.a)({},t.user),{},{location:{lat:r.lat(),long:r.lng()}}));var r},google:e.google,center:{lat:t.user.location.lat,lng:t.user.location.long},initialCenter:{lat:t.user.location.lat,lng:t.user.location.long},zoom:14,style:{height:500,width:"100%",margin:"0 auto",position:"relative"},containerStyle:{position:"relative",width:"100%",margin:"20px 0px"}},r.a.createElement(U.Marker,{onClick:function(){},title:"My location",name:"My location",position:{lat:t.user.location.lat,lng:t.user.location.long}}))),r.a.createElement("hr",null),r.a.createElement("h5",null,"Trending Locations"),r.a.createElement("h6",null,"See which locations are popular amongst all users."),r.a.createElement("br",null),r.a.createElement(ae,{locations:a.locations}),r.a.createElement("br",null),r.a.createElement(ne,{locations:a.locations}))})),ce=function(e){var t=Object(n.useContext)(d),a=[],c=[],o=Object(n.useState)({chartData:{labels:a,datasets:[{label:"Total Number of Comments",data:c,backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)"]}]}}),l=Object(m.a)(o,2),s=l[0],i=l[1];return Object(n.useEffect)((function(){t.getAllUsers().then((function(e){e?(e.sort((function(e,t){return function(e,t){return e-t}(e.comments.length,t.comments.length)})),e.reverse(),e[0]&&0!==e[0].comments.length&&(c.push(e[0].comments.length),a.push(e[0].username),e[1]&&0!==e[1].comments.length&&(c.push(e[1].comments.length),a.push(e[1].username),e[2]&&0!==e[2].comments.length&&(c.push(e[2].comments.length),a.push(e[2].username),e[3]&&0!==e[3].comments.length&&(c.push(e[3].comments.length),a.push(e[3].username),e[4]&&0!==e[4].comments.length&&(c.push(e[4].comments.length),a.push(e[4].username)))))),i({chartData:{labels:a,datasets:[{label:"Total Number of Comments",data:c,backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)"]}]}})):console.log("ERROR")}))}),[]),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"justify-content-center col"},r.a.createElement(te.a,{data:s.chartData,options:{title:{display:!0,text:"TOP 5 Users with Highest Comment Activity",fontSize:14,position:"right"},legend:{display:!1},scales:{xAxes:[{ticks:{beginAtZero:!0,stepSize:1},scaleLabel:{display:!0,labelString:"Total Number of Comments"}}]}}})))},oe=function(e){var t=Object(n.useContext)(d),a=[],c=[],o=Object(n.useState)({chartData:{labels:a,datasets:[{label:"Total Number of Favourites",data:c,backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)"]}]}}),l=Object(m.a)(o,2),s=l[0],i=l[1];return Object(n.useEffect)((function(){t.getAllUsers().then((function(e){e?(e.sort((function(e,t){return function(e,t){return e-t}(e.fav_stops.length,t.fav_stops.length)})),e.reverse(),e[0]&&0!==e[0].fav_stops.length&&(c.push(e[0].fav_stops.length),a.push(e[0].username),e[1]&&0!==e[1].fav_stops.length&&(c.push(e[1].fav_stops.length),a.push(e[1].username),e[2]&&0!==e[2].fav_stops.length&&(c.push(e[2].fav_stops.length),a.push(e[2].username),e[3]&&0!==e[3].fav_stops.length&&(c.push(e[3].fav_stops.length),a.push(e[3].username),e[4]&&0!==e[4].fav_stops.length&&(c.push(e[4].fav_stops.length),a.push(e[4].username)))))),i({chartData:{labels:a,datasets:[{label:"Total Number of Favourites",data:c,backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)"]}]}})):console.log("ERROR")}))}),[]),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"justify-content-center col"},r.a.createElement(te.a,{data:s.chartData,options:{title:{display:!0,text:"TOP 5 Users with Highest Favourite Activity",fontSize:14,position:"right"},legend:{display:!1},scales:{xAxes:[{ticks:{beginAtZero:!0,stepSize:1},scaleLabel:{display:!0,labelString:"Total Number of Favourites"}}]}}})))},le=a(98),se=a(240),ie=a.n(se),ue=a(260),me=a.n(ue),de=a(270),pe=a.n(de),fe=a(261),he=a.n(fe),be=a(268),ge=a.n(be),Ee=a(159),ve=a.n(Ee),je=a(158),Oe=a.n(je),ye=a(262),we=a.n(ye),Ce=a(263),xe=a.n(Ce),Ne=a(265),ke=a.n(Ne),Se=a(266),_e=a.n(Se),Re=a(267),Te=a.n(Re),Ae=a(271),Fe=a.n(Ae),Le=a(264),Pe=a.n(Le),De=a(269),Me=a.n(De),Ue=a(272),Ie=a.n(Ue),qe=function(e){var t={Add:Object(n.forwardRef)((function(e,t){return r.a.createElement(me.a,Object.assign({},e,{ref:t}))})),Check:Object(n.forwardRef)((function(e,t){return r.a.createElement(he.a,Object.assign({},e,{ref:t}))})),Clear:Object(n.forwardRef)((function(e,t){return r.a.createElement(Oe.a,Object.assign({},e,{ref:t}))})),Delete:Object(n.forwardRef)((function(e,t){return r.a.createElement(we.a,Object.assign({},e,{ref:t}))})),DetailPanel:Object(n.forwardRef)((function(e,t){return r.a.createElement(ve.a,Object.assign({},e,{ref:t}))})),Edit:Object(n.forwardRef)((function(e,t){return r.a.createElement(xe.a,Object.assign({},e,{ref:t}))})),Export:Object(n.forwardRef)((function(e,t){return r.a.createElement(Pe.a,Object.assign({},e,{ref:t}))})),Filter:Object(n.forwardRef)((function(e,t){return r.a.createElement(ke.a,Object.assign({},e,{ref:t}))})),FirstPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(_e.a,Object.assign({},e,{ref:t}))})),LastPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(Te.a,Object.assign({},e,{ref:t}))})),NextPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(ve.a,Object.assign({},e,{ref:t}))})),PreviousPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(ge.a,Object.assign({},e,{ref:t}))})),ResetSearch:Object(n.forwardRef)((function(e,t){return r.a.createElement(Oe.a,Object.assign({},e,{ref:t}))})),Search:Object(n.forwardRef)((function(e,t){return r.a.createElement(Me.a,Object.assign({},e,{ref:t}))})),SortArrow:Object(n.forwardRef)((function(e,t){return r.a.createElement(pe.a,Object.assign({},e,{ref:t}))})),ThirdStateCheck:Object(n.forwardRef)((function(e,t){return r.a.createElement(Fe.a,Object.assign({},e,{ref:t}))})),ViewColumn:Object(n.forwardRef)((function(e,t){return r.a.createElement(Ie.a,Object.assign({},e,{ref:t}))}))},a=Object(n.useContext)(d),c=Object(n.useState)({columns:[{title:"Username",field:"username"},{title:"Password(hashed)",field:"password"},{title:"Email",field:"email"}],data:[]}),o=Object(m.a)(c,2),l=o[0],s=o[1];Object(n.useEffect)((function(){a.getAllUsers().then((function(e){e&&s(Object(u.a)(Object(u.a)({},l),{},{data:e}))}))}),[]);return r.a.createElement(ie.a,{title:"Users",columns:l.columns,data:l.data,icons:t,editable:{onRowAdd:function(e){return function(e){return new Promise((function(t){a.createUser(e).then((function(e){t(),s((function(t){var a=Object(le.a)(t.data);return a.push(e),Object(u.a)(Object(u.a)({},t),{},{data:a})}))}))}))}(e)},onRowUpdate:function(e,t){return function(e,t){return new Promise((function(n){a.updateUser(t.username,e).then((function(e){n(),t&&s((function(a){var n=Object(le.a)(a.data);return n[n.indexOf(t)]=e,Object(u.a)(Object(u.a)({},a),{},{data:n})}))}))}))}(e,t)},onRowDelete:function(e){return function(e){return new Promise((function(t){a.deleteUser(e.username).then((function(a){a&&(t(),s((function(t){var a=Object(le.a)(t.data);return a.splice(a.indexOf(e),1),Object(u.a)(Object(u.a)({},t),{},{data:a})})))}))}))}(e)}}})},Ge=Object(U.GoogleApiWrapper)({apiKey:"AIzaSyCGXpHmTk63MUCUXfclORWPCTEh5B35qoQ"})((function(e){var t=Object(n.useContext)(d),a=(Object(n.useContext)(I),Object(x.f)());Object(n.useEffect)((function(){console.log("TEST","AdminPage"),t.loginAsAdmin()}),[]);return r.a.createElement(_.a,{className:"mt-3"},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("h5",null,"Hello, ",t.user.username),r.a.createElement(F.a,{variant:"primary",type:"submit",onClick:function(e){e.preventDefault(),window.confirm("Are you sure you want to sign out?")&&(t.signout(),a.push("/"))}},"Sign out",r.a.createElement(P.a,{className:"fa-signout",icon:D.n}))),r.a.createElement("hr",null),r.a.createElement("div",{className:"map-container"},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("h5",null,"My location"),r.a.createElement(z.a,{placement:"top",overlay:r.a.createElement(H.a,null,"Mark current position")},r.a.createElement(P.a,{onClick:function(){navigator.geolocation.getCurrentPosition((function(e){t.setUser(Object(u.a)(Object(u.a)({},t.user),{},{location:{lat:e.coords.latitude,long:e.coords.longitude}}))}))},className:"fa-crosshair",icon:D.b}))),r.a.createElement("h6",null,"Your can click on the map to modify your location"),r.a.createElement(U.Map,{onClick:function(e,a,n){return r=n.latLng,void t.setUser(Object(u.a)(Object(u.a)({},t.user),{},{location:{lat:r.lat(),long:r.lng()}}));var r},google:e.google,center:{lat:t.user.location.lat,lng:t.user.location.long},initialCenter:{lat:t.user.location.lat,lng:t.user.location.long},zoom:14,style:{height:500,width:"100%",margin:"0 auto",position:"relative"},containerStyle:{position:"relative",width:"100%",margin:"20px 0px"}},r.a.createElement(U.Marker,{onClick:function(){},title:"My location",name:"My location",position:{lat:t.user.location.lat,lng:t.user.location.long}}))),r.a.createElement("hr",null),r.a.createElement("h5",null,"User Management"),r.a.createElement(qe,null),r.a.createElement("hr",null),r.a.createElement("h5",null,"User Activity Statistics"),r.a.createElement("h6",null,"Track which users are most active by comments and favourites."),r.a.createElement("br",null),r.a.createElement(ce,null),r.a.createElement("br",null),r.a.createElement(oe,null),r.a.createElement("br",null))})),Ve=function(e){var t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],o=a[1],l=Object(n.useContext)(I);return r.a.createElement(_.a,{className:"grey-container mb-3 mt-3"},r.a.createElement(T.a,{onSubmit:function(t){t.preventDefault(),l.addComment(e.id,c)}},r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"Add Comment:"),r.a.createElement(T.a.Control,{as:"textarea",name:"content",type:"text",placeholder:"Comment",onChange:function(e){o(e.target.value)},value:c})),r.a.createElement(F.a,{variant:"primary",type:"submit"},"Submit")))},Be=a(749),ze=function(e){return r.a.createElement(Be.a,null,r.a.createElement(Be.a.Body,null,r.a.createElement(Be.a.Title,null,e.content),r.a.createElement(Be.a.Text,null,e.username)))},He=function(e){var t=Object(n.useContext)(d);return r.a.createElement("div",{className:"mt-5 mb-5"},r.a.createElement("h4",null,"Comments:"),0===e.comments.length?"No Comments Yet!":e.comments.map((function(e){return r.a.createElement(ze,{username:e.username,content:e.content})})),r.a.createElement("hr",null),t.user.logged_in?r.a.createElement(Ve,{id:e.id}):r.a.createElement("h5",{className:"mt-2 mb-3"},"Login to add a comment!"))},We=function(e){var t={Add:Object(n.forwardRef)((function(e,t){return r.a.createElement(me.a,Object.assign({},e,{ref:t}))})),Check:Object(n.forwardRef)((function(e,t){return r.a.createElement(he.a,Object.assign({},e,{ref:t}))})),Clear:Object(n.forwardRef)((function(e,t){return r.a.createElement(Oe.a,Object.assign({},e,{ref:t}))})),Delete:Object(n.forwardRef)((function(e,t){return r.a.createElement(we.a,Object.assign({},e,{ref:t}))})),DetailPanel:Object(n.forwardRef)((function(e,t){return r.a.createElement(ve.a,Object.assign({},e,{ref:t}))})),Edit:Object(n.forwardRef)((function(e,t){return r.a.createElement(xe.a,Object.assign({},e,{ref:t}))})),Export:Object(n.forwardRef)((function(e,t){return r.a.createElement(Pe.a,Object.assign({},e,{ref:t}))})),Filter:Object(n.forwardRef)((function(e,t){return r.a.createElement(ke.a,Object.assign({},e,{ref:t}))})),FirstPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(_e.a,Object.assign({},e,{ref:t}))})),LastPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(Te.a,Object.assign({},e,{ref:t}))})),NextPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(ve.a,Object.assign({},e,{ref:t}))})),PreviousPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(ge.a,Object.assign({},e,{ref:t}))})),ResetSearch:Object(n.forwardRef)((function(e,t){return r.a.createElement(Oe.a,Object.assign({},e,{ref:t}))})),Search:Object(n.forwardRef)((function(e,t){return r.a.createElement(Me.a,Object.assign({},e,{ref:t}))})),SortArrow:Object(n.forwardRef)((function(e,t){return r.a.createElement(pe.a,Object.assign({},e,{ref:t}))})),ThirdStateCheck:Object(n.forwardRef)((function(e,t){return r.a.createElement(Fe.a,Object.assign({},e,{ref:t}))})),ViewColumn:Object(n.forwardRef)((function(e,t){return r.a.createElement(Ie.a,Object.assign({},e,{ref:t}))}))},a=Object(n.useContext)(I),c=Object(n.useState)({columns:[{title:"Route",field:"route_id"},{title:"ETA",field:"eta"}],data:[],lastFetch:(new Date).toTimeString().slice(0,8)}),o=Object(m.a)(c,2),l=o[0],s=o[1];Object(n.useEffect)((function(){i(),setInterval(i,1e3)}),[]);var i=function(){a.getETA(e.stop_id).then((function(e){if(e){var t=[];e.map((function(e){e.eta.map((function(a,n){var r={id:e.route_id+n,route_id:e.route_id,eta:a+" mins",type:n?"child":"adult"};n&&(r.parentId=e.route_id+"0"),t.push(r)}))})),s(Object(u.a)(Object(u.a)({},l),{},{data:t,lastFetch:(new Date).toTimeString().slice(0,8)}))}}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("h5",null,"Estimated time of arrival(ETA)"),r.a.createElement("div",null,"last fetch: "+l.lastFetch)),r.a.createElement(ie.a,{title:"",columns:l.columns,data:l.data,icons:t,parentChildData:function(e,t){return t.find((function(t){return t.id===e.parentId}))}}))},Xe=Object(U.GoogleApiWrapper)({apiKey:"AIzaSyCGXpHmTk63MUCUXfclORWPCTEh5B35qoQ"})((function(e){var t=Object(n.useContext)(d),a=Object(n.useContext)(I),c=e.match.params.id,o=Object(n.useState)(null),l=Object(m.a)(o,2),s=l[0],i=l[1];return Object(n.useEffect)((function(){a.locations.length&&i(a.locations.find((function(e){return e.stop_id===c})))})),r.a.createElement(_.a,{className:"mt-3"},s?r.a.createElement(r.a.Fragment,null,r.a.createElement(X,{locations:[s],page:window.location.href.split("/")[3]}),r.a.createElement("hr",null),r.a.createElement(We,{stop_id:c}),r.a.createElement("hr",null),r.a.createElement(U.Map,{google:e.google,initialCenter:{lat:s.lat,lng:s.long},zoom:14,style:{height:500,width:"100%",margin:"0 auto",position:"relative"},containerStyle:{position:"relative",width:"100%",margin:"20px 0px"}},r.a.createElement(U.Marker,{title:s.name,name:s.name,position:{lat:s.lat,lng:s.long}})),t.user.logged_in?r.a.createElement("div",{className:"text-center "},r.a.createElement(F.a,{className:t.isFavorite(s.stop_id)?"fav-red":"fav-red-outline",onClick:function(){t.isFavorite(s.stop_id)?a.removeFav(s.stop_id):a.addFav(s.stop_id),t.favorite(s.stop_id)}},t.isFavorite(s.stop_id)?r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,{icon:D.d})," Favorite"):r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,{icon:D.e})," Not Favorite"))):"",r.a.createElement("hr",null),r.a.createElement(He,{id:s.stop_id,comments:s.comments})):"Loading...")})),Je=function(e){var t=Object(n.useContext)(I),a=Object(n.useContext)(d),c=function(e){return e*(Math.PI/180)},o="all"!==e.match.params.query?t.locations.filter((function(t){var n=e.match.params.query.toLowerCase();switch(e.match.params.field){case"id":return t.stop_id.toLowerCase().includes(n);case"name":return t.name.toLowerCase().includes(n);case"lat":return t.lat.toLowerCase().includes(n);case"long":return t.long.toLowerCase().includes(n);case"nearby":return n>=function(e,t){var n=a.user.location.lat,r=a.user.location.long,o=c(e-n),l=c(t-r),s=Math.sin(o/2)*Math.sin(o/2)+Math.cos(c(e))*Math.cos(c(n))*Math.sin(l/2)*Math.sin(l/2);return 6371*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}(t.lat,t.long)}})):t.locations;return r.a.createElement(_.a,{className:"mt-3"},"( "+o.length+" search results )",r.a.createElement(X,{locations:o}))},Qe=function(e){var t=Object(n.useContext)(I),a=Object(n.useContext)(d),c=Object(n.useState)({id:"",name:"",lat:"",long:""}),o=Object(m.a)(c,2),l=o[0],s=o[1],i=Object(n.useState)([{route_id:"",dir:"inbound"}]),p=Object(m.a)(i,2),f=p[0],h=p[1],b=Object(n.useState)(!1),g=Object(m.a)(b,2),E=g[0],v=g[1],j=function(e){s(Object(u.a)(Object(u.a)({},l),{},Object(B.a)({},e.target.name,e.target.value)))},O=function(e){return function(t){var a=f.map((function(a,n){return e!==n?a:Object(u.a)(Object(u.a)({},a),{},Object(B.a)({},t.target.name,t.target.value))}));h(a)}};return a.user.isAdmin?r.a.createElement(_.a,{className:"grey-container mb-3 mt-3"},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("h5",null,"Create Stop"),r.a.createElement(z.a,{placement:"top",overlay:r.a.createElement(H.a,null,"Create by CSV")},r.a.createElement(F.a,{variant:"success",onClick:function(){document.querySelector("input[type='file']").click()}},r.a.createElement("form",{id:"csv_form"},r.a.createElement("input",{type:"file",id:"file",name:"csv",hidden:!0,onChange:function(e){var a=document.querySelector("#csv_form"),n=new FormData(a);t.addCSVLoc(n).then((function(e){e&&v(!0)}))}})),r.a.createElement(P.a,{className:"fa-csv",icon:D.c})))),r.a.createElement(K.a,{variant:"success",hidden:!E},"Stop",l.name?' " '+l.name+' "':"s"," created!"),r.a.createElement("hr",null),r.a.createElement(T.a,{onSubmit:function(e){e.preventDefault(),t.addLoc(l,f).then((function(e){e&&v(!0)}))}},r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"Stop ID"),r.a.createElement(T.a.Control,{name:"id",type:"text",placeholder:"Stop ID",onChange:j,value:l.id,required:!0})),r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"Stop Name"),r.a.createElement(T.a.Control,{name:"name",type:"text",placeholder:"Stop Name",onChange:j,value:l.name,required:!0})),r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"Latitude"),r.a.createElement(T.a.Control,{name:"lat",type:"number",placeholder:"Latitude",onChange:j,value:l.lat,required:!0})),r.a.createElement(T.a.Group,null,r.a.createElement(T.a.Label,null,"Longitude"),r.a.createElement(T.a.Control,{name:"long",type:"number",placeholder:"Longitude",onChange:j,value:l.long,required:!0})),r.a.createElement("hr",null),r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("h6",null,"Related Routes"),r.a.createElement(z.a,{placement:"top",overlay:r.a.createElement(H.a,null,"Add Route Row")},r.a.createElement(F.a,{variant:"dark",className:"p-1",onClick:function(){h(f.concat([{route_id:"",dir:"inbound"}]))}},r.a.createElement(P.a,{className:"fa-plus",icon:D.k})))),f.map((function(e,t){return r.a.createElement("div",{className:"d-flex align-center",key:t},r.a.createElement(T.a.Group,{style:{width:"45%"}},r.a.createElement(T.a.Label,null,"Route ID"),r.a.createElement(T.a.Control,{name:"route_id",type:"text",placeholder:"Route ID",onChange:O(t),value:e.route_id,required:!0})),r.a.createElement(T.a.Group,{style:{width:"45%"}},r.a.createElement(T.a.Label,null,"Direction"),r.a.createElement(T.a.Control,{as:"select",name:"dir",onChange:O(t),value:e.dir,custom:!0},r.a.createElement("option",{value:"inbound"},"inbound"),r.a.createElement("option",{value:"outbound"},"outbound"))),r.a.createElement(T.a.Group,{className:"ml-1 btn-minus"},r.a.createElement(z.a,{placement:"top",overlay:r.a.createElement(H.a,null,"Delete Route Row")},r.a.createElement(F.a,{variant:"danger"},r.a.createElement(P.a,{className:"fa-minus",icon:D.i,onClick:function(){return function(e){h(f.filter((function(t,a){return e!==a})))}(t)}})))))})),r.a.createElement("hr",null),r.a.createElement(F.a,{variant:"primary",type:"submit"},"Create"))):r.a.createElement(_.a,{className:"mb-3 mt-3"},r.a.createElement("h5",null,"Only admin can access this page"))},Ye=a(750),Ke=a(742),Ze=function(){return r.a.createElement(_.a,{className:"mt-5"},r.a.createElement("h3",null,"About This Project"),r.a.createElement(Ye.a,{className:"mt-5 mb-5"},r.a.createElement(Ye.a.Item,null," ",r.a.createElement("h4",null,"1. Names and workload"),r.a.createElement(V.a,{striped:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Work done"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Anju Otsuka"),r.a.createElement("td",null)),r.a.createElement("tr",null,r.a.createElement("td",null,"Cheng Mo"),r.a.createElement("td",null)),r.a.createElement("tr",null,r.a.createElement("td",null,"Dineth Perera"),r.a.createElement("td",null,"Handled Bus stop database model, NodeJs backend routing for stop related queries and ETA calculation. Basic functionality of Admin location creation and ETA view pages.")),r.a.createElement("tr",null,r.a.createElement("td",null,"Yousif Alebyary"),r.a.createElement("td",null,"Fetching data from the backend and state-management. Basic functionality of list view, map view, user page, login/signup and search. About page"))))),r.a.createElement(Ye.a.Item,null,r.a.createElement("h4",{className:"mb-4"},"2. How To & specification"),r.a.createElement("h5",null,"User:")," ",r.a.createElement("p",null,'The users can create a new account or login to their preexisting one. Once logged in they can add locations to their favorites (which will show on their user page), and also comment on locations. They can also see the most popular locations in a chart. The users can also set their "home" location from their userpage and find all locations that are a certain distance away from their home location using the search bar Whether logged in or not they can see all of the locations in a list or map, and see comments, and ETA. And also sort or search locations using a certain field. The users can see the list of locations by going to (/list), and they can see the location map by going to (/map). Links are provided in the navbar. Clicking a location marker on the map or an entry on the list shows the location\'s page with its information, location on map and ETA. The User can comment and add the location to favorites from that page'),r.a.createElement("h5",null,"Admin:"),r.a.createElement("p",null,"The admin has the ability to see the most active users by comments and favorites. They can also perform CRUD operations on any user or location, as well as flushing the entire location database. The admin view is accessed by going to /admin. They can see user charts and change userdata in their user page (/admin), and they can change location data or flush it from the list page (/list)")),r.a.createElement(Ye.a.Item,null,r.a.createElement("h4",null,"3. Design of data schemas"),r.a.createElement(Ke.a,{fluid:!0,rounded:!0,src:"/uml.jpg",className:"mt-1 mb-1"}),r.a.createElement(Ke.a,{fluid:!0,rounded:!0,src:"/route.png",className:"mt-1 mb-1"}),r.a.createElement(Ke.a,{fluid:!0,rounded:!0,src:"/stop.png",className:"mt-1 mb-1"}),r.a.createElement(Ke.a,{fluid:!0,rounded:!0,src:"/user.png",className:"mt-1 mb-1"})),r.a.createElement(Ye.a.Item,null,r.a.createElement("h4",null,"4. Technologies in use and advantages:"),r.a.createElement("h5",null,"Technologies in use:"),"Mongoose, Express, React, NodeJs",r.a.createElement(V.a,{striped:!0,className:"mt-3 mb-3"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Advantages"),r.a.createElement("th",null,"Disadvantages"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"React"),r.a.createElement("td",null,r.a.createElement("p",null,"Easy to use: Everyone in our group has changed atleast part of the react code"),r.a.createElement("p",null,"Uses virtual DOM so it does not render the entire page everytime data changes")),r.a.createElement("td",null,r.a.createElement("p",null,"Only handles rendering, so we needed other modules to handle data fetching and routing"),r.a.createElement("p",null,"Multiple State-management solutions can be confusing"))),r.a.createElement("tr",null,r.a.createElement("td",null,"MongoDB + Mongoose"),r.a.createElement("td",null,r.a.createElement("p",null,"Schema-less nature (NoSQL) of MongDB gives more flexibility in the data stored compared to other SQL technologies."),r.a.createElement("p",null,"MongoDB utilises JSON-style (BSON) storage format, which allows for easy access and manipulation of data."),r.a.createElement("p",null,"Mongoose has easy to use syntax")),r.a.createElement("td",null,r.a.createElement("p",null,"Mongoose does not run as fast as native MongoDB"),r.a.createElement("p",null,"High memory consumption"))),r.a.createElement("tr",null,r.a.createElement("td",null,"NodeJs"),r.a.createElement("td",null,r.a.createElement("p",null,"Offers high performance")),r.a.createElement("td",null,r.a.createElement("p",null,"Requires a good understanding of asynchronous programming for API calls/database access")))))),r.a.createElement(Ye.a.Item,null,r.a.createElement("h4",null,"5. Academic honesty Article"),"Yes. We have read the academic honesty article carefully.")))},$e=function(){var e=Object(n.useContext)(d);return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.c,{basename:"/2053/proj",history:k},r.a.createElement(M,null),r.a.createElement(x.b,{path:"".concat("/2053","/"),component:e.user.logged_in?re:ee,exact:!0}),r.a.createElement(x.b,{path:"".concat("/2053","/about"),component:Ze,exact:!0}),r.a.createElement(x.b,{path:"".concat("/2053","/list"),component:J,exact:!0}),r.a.createElement(x.b,{path:"".concat("/2053","/map"),component:q,exact:!0}),r.a.createElement(x.b,{path:"".concat("/2053","/location/:id"),component:Xe,exact:!0}),r.a.createElement(x.b,{path:"".concat("/2053","/search/:field/:query"),component:Je,exact:!0}),r.a.createElement(x.b,{path:"".concat("/2053","/admin"),component:Ge,exact:!0}),r.a.createElement(x.b,{path:"".concat("/2053","/locationForm"),component:Qe,exact:!0})))},et=(a(703),a(704),function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"get",url:"/2053/api/stop",headers:{"Content-Type":"application/json;charset=utf-8"}});case 2:return t=e.sent,console.log(t.data.data),e.abrupt("return",t.data.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),tt=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"delete",url:"".concat("/2053/","api/stop/").concat(t),headers:{"Content-Type":"application/json;charset=utf-8"}});case 2:return a=e.sent,e.abrupt("return",a.data.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),at=function(){var e=Object(i.a)(s.a.mark((function e(t,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"put",url:"/2053/api/stop",headers:{"Content-Type":"application/json;charset=utf-8"},data:{stop_id:t,data:a}});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),nt=function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"post",url:"/2053/api/flush"});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),rt=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"post",url:"/2053/api/stop",headers:{"Content-Type":"application/json;charset=utf-8"},data:t});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ct=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"post",url:"/2053/api/stop/csv",headers:{"Content-Type":"multipart/form-data"},data:t});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ot=function(){var e=Object(i.a)(s.a.mark((function e(t,a,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"post",url:"/2053/api/comment",headers:{"Content-Type":"application/json;charset=utf-8"},data:{stop_id:t,username:a,content:n}});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),lt=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()({method:"get",url:"".concat("/2053/","api/eta/CTB/").concat(t),headers:{"Content-Type":"application/json;charset=utf-8"}});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),st=function(e){var t=Object(n.useContext)(d),a=Object(n.useState)([]),c=Object(m.a)(a,2),o=c[0],l=c[1],p=Object(n.useState)(!1),f=Object(m.a)(p,2),h=f[0],b=f[1],g=function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,et();case 2:t=e.sent,l(t),b(!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt();case 2:if(200!==e.sent.status){e.next=7;break}return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(i.a)(s.a.mark((function e(t,a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={stop_id:t.id,name:t.name,lat:t.lat,long:t.long,routes:a,company:"CTB"},e.next=3,rt(n);case 3:if(200!==e.sent.status){e.next=8;break}return e.abrupt("return",!0);case 8:console.log("ERROR");case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ct(t);case 2:if(200!==e.sent.status){e.next=7;break}return e.abrupt("return",!0);case 7:console.log("ERROR");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lt(t);case 2:if(200!==(a=e.sent).status){e.next=7;break}return e.abrupt("return",a.data);case 7:console.log("ERROR");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){h||g()})),r.a.createElement(I.Provider,{value:{locations:o,init:h,addComment:function(e,a){if(t.user.logged_in){var n=o.findIndex((function(t){return e===t.stop_id})),r=o[n];r.comments.push({username:t.user.username,content:a});var c=Object(le.a)(o);c[n]=r,l(c),ot(e,t.user.username,a)}},findById:function(e){return o.find((function(t){return t.stop_id===e}))},addFav:function(e){var t=o.findIndex((function(t){return e===t.stop_id})),a=o[t];a.favourite=a.favourite+1;var n=Object(le.a)(o);n[t]=a,l(n)},removeFav:function(e){var t=o.findIndex((function(t){return e===t.stop_id})),a=o[t];a.favourite=a.favourite-1;var n=Object(le.a)(o);n[t]=a,l(n)},reloadData:E,addLoc:v,addCSVLoc:j,deleteLoc:function(e){var t=o.findIndex((function(t){return e===t.stop_id})),a=o.splice(t,1),n=Object(le.a)(o);l(n),console.log("first"),tt(e).catch((function(e){l(n.push(a))}))},updateLoc:function(e,t){for(var a=o.findIndex((function(t){return e===t.stop_id})),n=o[a],r=o[a],c=0,s=Object.entries(t);c<s.length;c++){var i=Object(m.a)(s[c],2),d=i[0],p=i[1];r["id"===d?"stop_id":d]=p}var f=Object(le.a)(o);f[a]=Object(u.a)(Object(u.a)({},f[a]),{},{location:r}),l(f),console.log(o);var h={stop_id:t.id,name:t.name,lat:t.lat,long:t.long};at(e,h).catch((function(e){f[a]=n,l(f)}))},getETA:O}},e.children)};o.a.render(r.a.createElement(C,null,r.a.createElement(st,null,r.a.createElement($e,null))),document.querySelector("#root"))}},[[481,1,2]]]);
//# sourceMappingURL=main.3b11101e.chunk.js.map